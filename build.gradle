
// Konfiguration
qemuExecutable = "qemu-system-i386";

// Lade benutzerdefiniertes Skript, falls vorhanden.
if(file("user.gradle").exists()) {
    apply from: "user.gradle";
}

// Erzeugt das bootfähige Abbild.
task build << {
    exec {
        workingDir "sjc"
        commandLine "java", "-jar", "sjc.jar", "../src/", "-o",  "boot", "-u", "rte", "-Q", "-g"
    }
}

// Bootet das Abbild in QEMU.
task boot << {
    exec {
        workingDir "sjc"
        commandLine qemuExecutable, "-no-kvm", "-boot", "a", "-fda", "BOOT_FLP.IMG"
    }
}

// Räumt das Projektverzeichnis auf.
task clean << {
    delete {
        delete files("sjc/BOOT_FLP.IMG", "sjc/syminfo.txt")
    }
}
